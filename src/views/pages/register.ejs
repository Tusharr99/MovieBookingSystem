<%- include('../partials/header', { title }) %>
<section class="max-w-md mx-auto space-y-6">
  <div>
    <p class="text-sm uppercase tracking-wide text-emerald-300">Create account</p>
    <h1 class="text-2xl font-semibold">Register</h1>
  </div>
  <form id="registerForm" class="space-y-4 bg-slate-900 border border-slate-800 p-6 rounded-lg shadow-lg shadow-emerald-900/30">
    <div class="space-y-2">
      <label class="block text-sm text-slate-300">Name</label>
      <input id="name" type="text" name="name" class="w-full rounded bg-slate-800 border border-slate-700 px-3 py-2" placeholder="Your name" required>
    </div>
    <div class="space-y-2">
      <label class="block text-sm text-slate-300">Email</label>
      <input id="email" type="email" name="email" class="w-full rounded bg-slate-800 border border-slate-700 px-3 py-2" placeholder="you@example.com" required>
    </div>
    <div class="space-y-2">
      <label class="block text-sm text-slate-300">Password</label>
      <input id="password" type="password" name="password" class="w-full rounded bg-slate-800 border border-slate-700 px-3 py-2" placeholder="••••••••" required>
    </div>
    <div id="registerError" class="text-sm text-rose-300 hidden"></div>
    <button type="submit" class="w-full bg-emerald-500 hover:bg-emerald-400 text-slate-950 font-semibold py-2 rounded">
      Create account
    </button>
    <p class="text-sm text-slate-400">Already registered? <a class="text-emerald-300 hover:text-emerald-200" href="/login">Login</a></p>
  </form>
</section>
<script>
  const form = document.getElementById('registerForm');
  const errorBox = document.getElementById('registerError');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    errorBox.classList.add('hidden');
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    try {
      const res = await fetch('/api/auth/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'same-origin',
        body: JSON.stringify({ name, email, password })
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.message || 'Registration failed');
      window.location.href = '/';
    } catch (err) {
      errorBox.textContent = err.message;
      errorBox.classList.remove('hidden');
    }
  });
</script>
<%- include('../partials/footer') %>

